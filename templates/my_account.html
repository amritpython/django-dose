<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Account</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/static/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/static/css/custom.css" />
    {% include 'base/head.html' %}
    <style>
        body {
            background-color: #F3F3F3;
        }
        .page-item:hover{
            background-color: black;
            color: white;
        }
        .page-item{
            text-decoration: none;
            color:black;
            margin:0 1px;
            padding:4px 0;
            border-radius: 4px;
        }
        .page-item:link{
            text-decoration: none;
            color: black;

        }
        .page-item-active{
            background-color: black;
            color: white;
        }
        li > a:link{
            color:black;
            text-decoration: none;
        }
    </style>
</head>

<body>
    {% include 'base/header.html' %}
    <!-- My Account Section -->
    <section id="my_account">
        <div class="container">
            <h1>MY ACCOUNT</h1>
            <a class="logout" href="/logout" title="Logout">Logout</a>
            <div class="border_top">
                <div style="display: flex;width: 100%;">
                    <div class="col-sm-6" style="flex-grow:1;">
                        <div class="order_history" style="width: 100%;">
                            <h4>Order History</h4>
                            {% if customer_orders|length == 0 %}
                            <p>You have not place any order yet.</p>
                            {% else %}
                            <div class="small-12 large-8 columns myaccount-content" style="width: 100%;">
                                <table class="shop_table" style="width: 100%;">
                                    <thead>
                                        <tr>
                                            <th>Order</th>
                                            <th>Date</th>
                                            <th>Payment Status</th>
                                            <th>Fulfillment Status</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for order in customer_orders %}
                                        <tr>
                                            <td>
                                                <p>{{order.id}}</p>
                                            </td>
                                            <td><time
                                                    datetime="{{order.updated_at}}">{{order.updated_at_formatted}}</time>
                                            </td>
                                            <td>{{order.financial_status}}</td>
                                            <td>{% if order.fulfillment_status %}Fulfilled{% else %}Unfulfilled{% endif %}</td>
                                            <td>${{order.current_subtotal_price}} {{order.currency}}</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>

                            </div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="col-sm-6" style="width: fit-content;">
                        <div class="d-sm-flex justify-content-end">
                            <div class="order_history mt-3 mt-sm-0">
                                <h4>Account Details</h4>
                                <p>{{request.user.first_name}} {{request.user.last_name}}</p>
                                <p>{{request.user.address_country}}</p>
                                <p><a href="{{request.user.shop}}/account/addresses">View Addresses</a></p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <h2>Order Quiz</h2>
            {% for form in user_forms %}
            <div class="set">
                <div class="row align-items-center align-items-center">
                    <div class="col-md-4 col-sm-12">
                        <h3>{{form.formatted_form_type}}</h3>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        {% if form.is_completed %}
                        <h4><i class="bi bi-check-circle-fill"></i>Consultation completed</h4>
                        {% endif %}
                    </div>
                    {% if form.is_completed %}
                    <div class="col-md-4 col-sm-6 text-end">
                        <a href="/consulation_result/{{form.id}}" title="View result" class="btn">View result</a>
                    </div>
                    {% else %}
                    <div class="col-md-4 col-sm-6 text-end"><a href="/{{form.form_type}}?id={{form.id}}"
                            title="View result" class="btn fill">Take ONLINE
                            CONSULTATIONt</a>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
            {% if user_forms.0 %}
            <div style="width: 100%;display: flex;justify-content: end;margin-top: 40px;">
            <ul style="width: fit-content;display: flex; padding: 10px;border-radius: 5px; box-shadow: 0 0 4px 2px lightgray;list-style-type: none;">
                {% if page_obj.has_previous %}
                <li class="page-item">
                    <a class="hover:bg-slate-500 hover:text-white rounded-md p-1 px-3"
                        href="{% if query_str %}{{query_str}}&{% else%}?{% endif %}page={{page_obj.previous_page_number}}"
                        aria-label="Previous" style="color: black;" onmouseover="this.style.color='white';" onmouseleave="this.style.color='black';">
                        <span>
                            &larr;
                        </span>
                    </a>
                </li>
                {% endif %}
                {% for i in page_obj.paginator.page_range %}
                    {% if i in reqs %}
                        {% if i == page_obj.number %}
                            <li class="page-item page-item-active"><a class="bg-slate-500 text-white rounded-md p-1 px-3" href="{% if query_str %}{{query_str}}&{% else%}?{% endif %}page={{i}}">{{i}}</a></li>
                        {% else %}
                            <li class="page-item page-item-inactive"><a class="hover:bg-slate-500 hover:text-white rounded-md p-1 px-3" href="{% if query_str %}{{query_str}}&{% else%}?{% endif %}page={{i}}" style="color:black" onmouseover="this.style.color='white';" onmouseleave="this.style.color='black';">{{i}}</a></li>
                        {% endif %}
                    {% else %}
                        {% if i in dots %}
                            <li class="w-fit select-none" style="user-select: none;">.</li>
                        {% endif %}    
                    {% endif %}
                {% endfor %}
                {% if page_obj.has_next %}
                <li class="page-item">
                    <a class="hover:bg-slate-500 hover:text-white rounded-md p-1 px-3"
                        href="{% if query_str %}{{query_str}}&{% else%}?{% endif %}page={{page_obj.next_page_number}}"
                        aria-label="Next" style="color:black;" onmouseover="this.style.color='white';" onmouseleave="this.style.color='black';">
                        <span>
                            &#8594;
                        </span>
                    </a>
                </li>
                {% endif %}
            </ul>
            </div>
            {% else %}
            You have not taken any quiz yet, click on the Online Consultation button on top and start your first quiz
            {% endif %}
        </div>
    </section>
    {% include 'base/footer.html' %}
</body>

</html>